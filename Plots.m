clear all; clc; close all;

% Plotting
f = [0.5, 0.51, 0.52, 0.53, 0.54, 0.55, 0.56, 0.5700000000000001, 0.58, 0.59, 0.6, 0.61, 0.62, 0.63, 0.64, 0.65, 0.66, 0.67, 0.6799999999999999, 0.69, 0.7, 0.71, 0.72, 0.73, 0.74, 0.75, 0.76, 0.77, 0.78, 0.79, 0.8, 0.81, 0.8200000000000001, 0.8300000000000001, 0.8400000000000001, 0.8500000000000001, 0.86, 0.87, 0.88, 0.89, 0.9, 0.91, 0.9199999999999999, 0.9299999999999999, 0.94, 0.95, 0.96, 0.97, 0.98, 0.99, 1.0, 1.01, 1.02, 1.03, 1.04, 1.05, 1.06, 1.07, 1.08, 1.0899999999999999, 1.1, 1.1099999999999999, 1.12, 1.13, 1.1400000000000001, 1.15, 1.1600000000000001, 1.17, 1.1800000000000002, 1.19, 1.2000000000000002, 1.21, 1.22, 1.23, 1.24, 1.25, 1.26, 1.27, 1.28, 1.29, 1.3, 1.31, 1.32, 1.33, 1.3399999999999999, 1.35, 1.3599999999999999, 1.37, 1.38, 1.3900000000000001, 1.4, 1.4100000000000001, 1.42, 1.4300000000000002, 1.44, 1.4500000000000002, 1.46, 1.47, 1.48, 1.49, 1.5, 1.51, 1.52, 1.53, 1.54, 1.55, 1.56, 1.57, 1.58, 1.59, 1.6, 1.61, 1.62, 1.6300000000000001, 1.6400000000000001, 1.6500000000000001, 1.66, 1.67, 1.68, 1.69, 1.7, 1.71, 1.72, 1.73, 1.74, 1.75, 1.76, 1.77, 1.78, 1.79, 1.8, 1.81, 1.82, 1.83, 1.84, 1.85, 1.86, 1.87, 1.8800000000000001, 1.8900000000000001, 1.9000000000000001, 1.91, 1.92, 1.93, 1.94, 1.95, 1.96, 1.97, 1.98, 1.99];
masspeakVx = (1/10)*[29.73668753698604, 30.030102611122786, 30.09810996169476, 30.232776983600157, 30.471305554345307, 30.707849397478608, 30.905929896725052, 31.101967175804916, 31.34887241478205, 31.448878489081494, 31.77557429778962, 31.97557665870722, 32.18345931977571, 32.2380229602256, 32.58766469924061, 32.81185278172022, 32.98566031993718, 32.838369479602804, 33.527066780016824, 33.76727074975612, 33.948994349388514, 34.24115930753552, 34.55018147917134, 34.75873233193689, 35.00538740613583, 35.363283197853164, 35.44978907273612, 35.93708661216214, 36.02003229018307, 36.47178119489138, 36.730890501948046, 37.097147637297574, 37.37138610932847, 37.70703269665243, 37.97983518862352, 38.40290745707216, 38.62021930125007, 35.660803075786916, 39.427400892566844, 39.65116740120152, 40.04581408081366, 40.535964563336165, 40.935005808660605, 41.31385780530693, 41.68727493991104, 42.05926736262463, 42.661268031947564, 43.13609389125466, 43.49779140643743, 43.98785071710496, 44.4633150027274, 45.04691919174591, 45.46060023962446, 45.96477924787736, 46.548217178382544, 47.112103147879246, 47.63747100113702, 48.32864126086133, 48.81691627312736, 49.49342604527185, 49.88582394748731, 50.786922215106635, 51.49919991754825, 52.02765560521852, 52.70936866630463, 53.6913826374346, 53.46992319206385, 54.90954250337227, 56.00768757802932, 56.67306598730122, 57.767174850142865, 58.718319275895695, 59.79238188068361, 60.54052979288768, 61.539727511256075, 62.9353403562032, 63.97976827517668, 65.10090468981778, 66.37785793977918, 67.6303372062836, 69.15094552949111, 70.46686226931384, 72.03140165108238, 73.53415402944101, 75.09596372331092, 76.4898048264124, 78.68726831581998, 80.34029188249205, 82.28115253313089, 84.70523449211366, 86.77786405172094, 89.03580342199795, 91.77636086214225, 94.04887925607385, 97.28418557346146, 100.20496243271324, 103.43679740158862, 106.9298782365482, 110.57738182813995, 114.45573766245091, 119.23279555880505, 124.02397009134265, 129.09514072741456, 134.1890667613397, 140.94436471447005, 148.21399627187404, 155.44848088336028, 164.43654734370782, 173.4062142832419, 184.95548490131148, 197.23947894399552, 211.85340890997261, 227.86732893803193, 247.87036988439013, 271.34619189429975, 299.60733053985837, 336.2645529202965, 381.8102891614748, 441.9796336186792, 526.429571228257, 650.5825026159179, 853.841841148667, 1243.8641593519535, 2050.596209272535, 2501.4687599986223, 2249.3703203048913, 1449.238739348599, 935.5139547966417, 688.53310483536, 544.4193680130389, 450.45688251241006, 383.5636920533312, 333.69265650305294, 294.8408870910676, 263.80209983206, 239.1769008814751, 218.15671279131436, 200.4030095497035, 185.5172838700883, 171.74062498656158, 160.85842045945006, 151.01981911428865, 142.13165224034947, 134.13520841571005, 127.20377828679429, 120.40206349737147, 114.62000985866474, 109.16582763829082, 104.56104494710654, 99.58416993168407];
masspeakMy = (1/10)*(1/12)*[18940.738572726983, 19136.797010980754, 19217.38896751375, 19324.569151695552, 19516.554354725944, 19692.798135627985, 19859.090263116017, 20025.16585182616, 20206.53038137865, 20339.8913505411, 20542.34468392721, 20708.792280659676, 20874.809257007488, 20993.48212117236, 21216.39259795742, 21383.91323204894, 21548.150129234997, 21497.812903864717, 21974.58389607978, 22158.123853732275, 22335.45330461651, 22541.71423563955, 22775.376024822708, 22974.568737750476, 23194.841257060692, 23437.846627234176, 23562.4584175104, 23895.74044173133, 24041.003483432392, 24351.019657739766, 24568.041050427222, 24848.847990447575, 25087.31723212568, 25350.585705925423, 25595.704438095956, 25907.09108039529, 26130.50718601758, 24049.164303654343, 26744.293741100428, 27007.058122317972, 27273.104577857383, 27651.191598936202, 27972.11918102343, 28280.72838247784, 28628.281262783174, 28879.54678732339, 29347.834272903816, 29719.807132341444, 30040.36270260871, 30453.5779929609, 30838.5814959812, 31271.957215944054, 31652.266045956072, 32067.603768325807, 32533.87938132956, 32985.84370055362, 33421.66962983839, 33921.88369392653, 34383.531242356075, 34892.08997599182, 35321.38358804199, 35943.651589726316, 36530.01746674146, 37020.58477649026, 37563.47879938392, 38317.31003476536, 38208.18863180253, 39449.10554805089, 40234.457220107295, 40871.20866002541, 41657.17566276602, 42429.55745437081, 43255.47872372638, 43918.09968185919, 44842.88472917835, 45795.2778119088, 46642.80849854848, 47622.26100390749, 48638.76008658113, 49695.48011679164, 50845.45785957788, 51917.85671580291, 53188.49911737811, 54419.41034642419, 55697.047459840236, 57016.50225670536, 58596.27821564109, 59990.14471462208, 61669.71279879219, 63482.32393170668, 65254.291653477085, 67026.73383452228, 69249.62499943776, 71222.76348116931, 73729.91621549963, 76186.9400958509, 78781.23459006622, 81675.01430835963, 84658.89227234597, 87956.0243129546, 91648.62208509896, 95559.41152871991, 99686.12705163848, 104219.22691768118, 109459.02419843961, 115194.51609774164, 121275.18410519004, 128434.33417195818, 136056.0963622178, 145172.30406039537, 155222.43006464167, 167003.870997355, 180360.6120617441, 196515.7055941664, 215642.308171231, 238842.41752424007, 268327.77303523244, 305387.80816740426, 354727.13736846077, 423255.50501463533, 524485.034515614, 689837.8760011436, 1007683.2626702216, 1665054.9901015488, 2036265.5532180574, 1835699.393318603, 1185267.7733740122, 766847.1924326202, 566307.790267378, 448829.1123794843, 371906.6310801898, 317345.45222701656, 276688.7589087214, 245164.51781415992, 219951.16543924809, 199718.07377120538, 182688.6028612474, 168339.25987960433, 156062.00618378245, 145257.59160873282, 135947.57680768456, 127994.06969031345, 120739.16378181546, 114252.47362817623, 108528.94473581738, 103085.56987559781, 98336.51319334832, 93964.55969776795, 90071.79747303478, 86142.85644079294];
nomasspeakVx = (1/10)*[15.274103519264086, 15.274115120322238, 15.324870918181647, 15.355027598569817, 15.379256878775282, 15.40991804420362, 15.428246974609555, 15.434424798089328, 15.508534878192968, 15.502230136286116, 15.543980391764554, 15.571574653282084, 15.56792155416201, 15.642131250022857, 15.668237644000564, 15.700542536478563, 15.720352963820298, 15.746595523949237, 15.670293896930316, 15.654062332430643, 15.821420249796336, 15.866275322853967, 15.904882294312115, 15.927386147754056, 15.936108607639454, 16.001307809372978, 16.015240982055523, 15.516680270080528, 16.032602278829998, 16.10957413617295, 16.167772383727574, 16.184377898844208, 16.199816637815797, 16.266798229560813, 16.285990532303018, 16.312716728036, 16.36781083943099, 16.390164774042013, 16.393435955364208, 16.46622190693616, 16.49511276250836, 16.534137102777, 16.525824649345672, 16.552105629843417, 16.607686882179987, 16.675550401573382, 16.682242834510916, 16.721560051114565, 16.77719576125181, 16.79653061639197, 16.81950163180313, 16.89324353913837, 16.867660490641075, 16.92090825963278, 16.955505000979688, 17.00317165021122, 17.044821572258453, 17.10268818576315, 17.124960925983824, 17.15411098013309, 17.15056918362123, 17.220387093851013, 17.30171762832537, 17.291943414710413, 17.391708692093463, 17.322954883446275, 17.44442161727135, 17.488773221892586, 17.56773154463708, 17.560626261503323, 17.620357970728367, 17.679316349989627, 17.724839401739484, 17.712223867963658, 17.72953627825496, 17.82883327628578, 17.80608773750969, 17.91185587933906, 17.90135141243039, 17.959782289113864, 18.01764712303968, 18.052251524506328, 18.15688843070285, 18.204847887992347, 18.183455785933663, 18.256518145904504, 18.242079446662864, 18.412078845466336, 18.363734571470545, 18.498948358799428, 18.494237004940555, 18.540046641004036, 18.578834454675366, 18.660797664014073, 18.74383265176941, 18.80013434685896, 18.817322130073766, 18.841966482554547, 18.94046991380116, 18.96460361875525, 19.002342822249087, 19.086034781116183, 19.11151244601383, 19.18566488169938, 19.251147264188802, 19.243775584090237, 19.346249489472164, 19.423184383569428, 19.4357708994814, 19.452603317603266, 19.566940936460107, 19.663096808737873, 19.714522796242935, 19.689124688560533, 19.843541799577707, 19.871921274324283, 19.90614202413975, 20.02143274282691, 20.025542953961533, 20.114990014020098, 20.1138490683713, 20.281981529206814, 20.307669510323592, 20.3294363589996, 20.42208934429734, 20.52150517465378, 20.594796802350118, 20.64111119025755, 20.655962804706697, 20.782382204684442, 20.748209664102507, 20.861097511258873, 20.951978769360593, 21.09552215467909, 21.11840814044446, 21.026487434180552, 21.134216543294112, 21.342205067452777, 21.315173761180375, 21.515777017985112, 21.58715114034604, 21.566965927117238, 21.656525483074333, 20.00739159230067, 21.851371935863295, 21.966983694250537, 22.017462418153514, 22.046370569863587, 22.164215528246753, 21.807813393626603];
nomasspeakMy = (1/10)*(1/12)*[6274.813418406976, 6282.543036251999, 6305.643101183309, 6325.6518546721745, 6339.736382003615, 6357.179938738326, 6367.873440758804, 6380.156974327262, 6411.814399091212, 6420.115599497883, 6441.47935429861, 6455.037061391553, 6461.58422910181, 6494.801500649302, 6512.136325893165, 6529.264831884692, 6543.708742601979, 6562.773260553347, 6545.725544956467, 6552.304810947749, 6613.629127956611, 6633.776637786711, 6652.846023846556, 6675.051455401493, 6689.195329129383, 6713.115810681534, 6729.6518817861315, 6517.75309366217, 6752.408366292436, 6787.835979180831, 6811.728435523019, 6822.749225146301, 6845.612812672145, 6870.339940080251, 6888.955042055412, 6905.941771545173, 6931.930353938536, 6950.432512632019, 6961.649455562147, 6989.423867458215, 7008.342478847458, 7031.175162763746, 7046.23073166438, 7061.678906175328, 7088.403259746112, 7118.7156126219115, 7133.554098807734, 7158.660851661069, 7183.399940679719, 7200.172696481362, 7217.45547964167, 7249.878153236357, 7252.236854124664, 7285.332184748478, 7310.1608754168365, 7325.844395185126, 7354.335206529601, 7385.254423010175, 7404.912946706701, 7423.110654155162, 7429.339620415638, 7466.836163896435, 7505.035614420326, 7518.371342330058, 7554.332348138918, 7552.753237527053, 7600.527271803249, 7623.489871091286, 7657.778401611572, 7669.191298473576, 7700.614785428256, 7733.343035941377, 7757.439835596865, 7769.713547798388, 7780.508742057253, 7832.726834144852, 7837.322822095225, 7886.398705447738, 7895.140104847502, 7933.32397061205, 7958.365789415041, 7984.2688868185005, 8025.1479361775055, 8058.208555948593, 8058.348406946312, 8109.038718340661, 8115.9336762903995, 8173.854119820731, 8166.204760487346, 8231.100723484848, 8252.766442181775, 8278.424359318056, 8314.537685045949, 8343.492740610454, 8385.576855737836, 8417.02359816469, 8441.683300577726, 8460.417451808367, 8503.57520085474, 8538.493735119244, 8561.649246482935, 8604.966639921666, 8618.721283983326, 8661.700653710257, 8703.247892478676, 8708.119263086292, 8766.979375374834, 8808.829021290607, 8832.55758552817, 8830.458173557186, 8902.509461028661, 8949.327592883088, 8975.887640184657, 9011.023122865448, 9057.571407839074, 9091.31132024039, 9125.886592584393, 9172.288672042909, 9186.054285431983, 9234.60523807133, 9260.692179274232, 9322.667517533411, 9353.530886076573, 9387.315664382424, 9429.801317224703, 9481.966810896143, 9523.623113025234, 9556.26083756651, 9591.007375400872, 9646.829967150925, 9651.0780662308, 9711.598035545638, 9763.482908515167, 9824.26938421964, 9861.401134796559, 9839.557425100895, 9902.41006758298, 9990.263935318726, 10006.994327615083, 10091.169191566609, 10140.886536456472, 10165.59581398083, 10209.599625879238, 9380.424379832411, 10318.810969739163, 10379.403053626906, 10425.827866542553, 10466.425891996607, 10517.387012406047, 10448.97723490571];
[valmpVx, impVx] = max(masspeakVx);
[valmpMy, impMy] =  max(masspeakMy);
[valnompVx,inompVx] = max(nomasspeakVx);
[valnompMy, inompMy] = max(nomasspeakMy)
f1 = 0.5
f2 = 2

figure(1)
subplot(2,2,1);
plot(f, masspeakVx)
hold on
plot(f(impVx), valmpVx, 'or')
text(f(impVx), valmpVx, num2str(valmpVx))
title('$V_{b}$ vs $f_{f}$ with Lumped Mass', 'Interpreter','latex', 'FontSize', 24)
xlabel('Forcing Frequency $f_{f}$ (Hz)','Interpreter','latex', 'FontSize', 16)
ylabel('Peak Base Shear $V_{bx}$ (kips)','Interpreter','latex', 'FontSize', 16)
xlim([f1,f2]);
grid on

subplot(2,2,2);
plot(f, masspeakMy)
hold on
plot(f(impMy), valmpMy, 'or')
text(f(impMy), valmpMy, num2str(valmpMy))
title('$M_{b}$ vs $f_{f}$ with Lumped Mass', 'Interpreter','latex', 'FontSize', 24)
xlabel('Forcing Frequency $f_{f}$ (Hz)','Interpreter','latex', 'FontSize', 16)
ylabel('Peak Overturning Moment $M_{by}$ (kip*ft)','Interpreter','latex', 'FontSize', 16)
xlim([f1,f2]);
grid on

subplot(2,2,3);
plot(f, nomasspeakVx)
hold on
plot(f(inompVx), valnompVx, 'or')
text(f(inompVx), valnompVx, num2str(valnompVx))
title('$V_{b}$ vs $f_{f}$ with No Lumped Mass', 'Interpreter','latex', 'FontSize', 24)
xlabel('Forcing Frequency $f_{f}$ (Hz)','Interpreter','latex', 'FontSize', 16)
ylabel('Peak Base Shear $V_{bx}$ (kips)','Interpreter','latex', 'FontSize', 16)
xlim([f1,f2]);
grid on

subplot(2,2,4);
plot(f, nomasspeakMy)
hold on
plot(f(inompMy), valnompMy, 'or')
text(f(inompMy), valnompMy/12, num2str(valnompMy))
title('$M_{b}$ vs $f_{f}$ with No Lumped Mass', 'Interpreter','latex', 'FontSize', 24)
xlabel('Forcing Frequency $f_{f}$ (Hz)','Interpreter','latex', 'FontSize', 16)
ylabel('Peak Overturning Moment $M_{by}$ (kip*ft)','Interpreter','latex', 'FontSize', 16)
xlim([f1,f2]);
grid on



